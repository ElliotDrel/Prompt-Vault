---
phase: 12-shared-component-architecture
plan: 02
type: execute
domain: react-typescript
---

<objective>
Extract reusable prompt list filtering/sorting logic and create a shared PromptListView component.

Purpose: Decouple the list presentation logic from Dashboard so it can be reused by the public library page (Phase 15) and potentially other prompt list views.
Output: New `usePromptFilters` hook and `PromptListView` component that Dashboard will consume.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-shared-component-architecture/12-01-PLAN.md

# Types from Plan 01 (will be completed before this plan runs):
@src/types/prompt.ts

# Current Dashboard implementation to extract from:
@src/components/Dashboard.tsx

# Existing component patterns:
@src/components/PromptCard.tsx
@src/pages/Index.tsx

**Tech stack available:**
- React 18.3 with hooks
- Framer Motion for animations
- Tailwind CSS for styling
- shadcn/ui components

**Established patterns:**
- Hooks in `src/hooks/`
- Components in `src/components/`
- Grid layout: 1 col mobile, 2 tablet, 3 desktop, 4 xl
- Framer Motion staggered animations (0.1s delay)
- Empty states with icon + message + optional CTA

**Constraining decisions:**
- Phase 12: Shared components must work for both owned and public prompts
- Dashboard keeps user-specific stats and "Create" button
- List view handles filtering, sorting, grid layout, empty states

**Context from exploration:**
Dashboard currently handles:
1. Search filtering (case-insensitive title match)
2. Sort selection (name, lastUpdated, usage)
3. Sort direction toggle
4. Pinned-first sorting
5. Grid layout with responsive columns
6. Loading state (spinner)
7. Empty states (no prompts, no results)
8. Stats display (via StatsCounter)

The extraction should:
- Move search/sort state to a custom hook
- Move grid/empty state rendering to PromptListView
- Keep stats and "Create" button in Dashboard (user-specific)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create usePromptFilters hook</name>
  <files>src/hooks/usePromptFilters.ts</files>
  <action>
Create a new custom hook that encapsulates filtering and sorting logic:

```typescript
import { useMemo, useState } from 'react';
import type { Prompt } from '@/types/prompt';

export type SortBy = 'name' | 'lastUpdated' | 'usage';
export type SortDirection = 'asc' | 'desc';

interface UsePromptFiltersOptions {
  prompts: Prompt[];
  initialSortBy?: SortBy;
  initialSortDirection?: SortDirection;
  pinFirst?: boolean;  // Whether to sort pinned items to top (default: true)
}

interface UsePromptFiltersReturn {
  // State
  searchTerm: string;
  sortBy: SortBy;
  sortDirection: SortDirection;

  // Setters
  setSearchTerm: (term: string) => void;
  setSortBy: (by: SortBy) => void;
  setSortDirection: (dir: SortDirection) => void;
  toggleSortDirection: () => void;

  // Computed
  filteredPrompts: Prompt[];
  hasResults: boolean;
  isEmpty: boolean;  // true if prompts array was empty
  isFiltered: boolean;  // true if searchTerm is active
}

export function usePromptFilters(options: UsePromptFiltersOptions): UsePromptFiltersReturn {
  // Implementation:
  // 1. State for searchTerm, sortBy, sortDirection
  // 2. useMemo for filteredPrompts that:
  //    - Filters by searchTerm (case-insensitive title.includes)
  //    - Sorts by selected criteria
  //    - Puts pinned items first if pinFirst=true
  // 3. Derive hasResults, isEmpty, isFiltered from state
}
```

Key implementation details:
- Default pinFirst to true
- Default sortBy to 'lastUpdated'
- Default sortDirection to 'desc'
- Sorting comparators:
  - name: localeCompare on title
  - lastUpdated: Date comparison on updatedAt
  - usage: numeric comparison on timesUsed (default 0)
- Pinned sorting: stable sort with isPinned=true items first

Export the types (SortBy, SortDirection) for consumers.
  </action>
  <verify>npm run build passes, hook can be imported without errors</verify>
  <done>usePromptFilters hook created with search/sort state management and filtered results computation</done>
</task>

<task type="auto">
  <name>Task 2: Create PromptListView component</name>
  <files>src/components/PromptListView.tsx</files>
  <action>
Create a reusable component for displaying a grid of prompts with search/sort controls and empty states:

```typescript
import type { Prompt, PromptVariant } from '@/types/prompt';
import type { SortBy, SortDirection } from '@/hooks/usePromptFilters';

interface PromptListViewProps {
  // Data
  prompts: Prompt[];
  loading?: boolean;

  // Filter state (controlled)
  searchTerm: string;
  sortBy: SortBy;
  sortDirection: SortDirection;
  onSearchChange: (term: string) => void;
  onSortByChange: (by: SortBy) => void;
  onSortDirectionChange: (dir: SortDirection) => void;

  // Rendering customization
  renderPromptCard: (prompt: Prompt, index: number) => React.ReactNode;

  // Empty state customization
  emptyIcon?: React.ReactNode;
  emptyTitle?: string;
  emptyDescription?: string;
  emptyAction?: React.ReactNode;  // e.g., "Create your first prompt" button

  // No results customization (when search has no matches)
  noResultsTitle?: string;
  noResultsDescription?: string;
}
```

Component structure:
1. **Search bar** - Input with search icon, clear button when has value
2. **Sort controls** - Dropdown for sortBy + button for direction toggle
3. **Results count** - "X prompts" or "X results" when filtered
4. **Grid layout** - Responsive: grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6
5. **Loading state** - Spinner with "Loading prompts..."
6. **Empty state** - Icon + title + description + optional action
7. **No results state** - Different message when search has no matches

Use Framer Motion for:
- Grid item staggered animation (0.1s delay)
- Individual card fade-in (opacity 0→1, y 10→0)

Extract styles from existing Dashboard.tsx to maintain visual consistency.

Do NOT include:
- Stats display (Dashboard-specific)
- "Create prompt" floating button (Dashboard-specific)
- Any data fetching (parent provides prompts array)
  </action>
  <verify>npm run build passes, component renders without errors in isolation</verify>
  <done>PromptListView component created with search/sort controls, grid layout, and customizable empty states</done>
</task>

<task type="auto">
  <name>Task 3: Refactor Dashboard to use new components</name>
  <files>src/components/Dashboard.tsx</files>
  <action>
Refactor Dashboard.tsx to use the new usePromptFilters hook and PromptListView component:

1. **Replace inline state** with usePromptFilters hook:
   ```typescript
   const {
     searchTerm, sortBy, sortDirection,
     setSearchTerm, setSortBy, toggleSortDirection,
     filteredPrompts, isEmpty, isFiltered
   } = usePromptFilters({ prompts, pinFirst: true });
   ```

2. **Replace inline grid/controls** with PromptListView:
   ```typescript
   <PromptListView
     prompts={filteredPrompts}
     loading={loading}
     searchTerm={searchTerm}
     sortBy={sortBy}
     sortDirection={sortDirection}
     onSearchChange={setSearchTerm}
     onSortByChange={setSortBy}
     onSortDirectionChange={toggleSortDirection}
     renderPromptCard={(prompt, index) => (
       <PromptCard
         key={prompt.id}
         prompt={prompt}
         to={`/dashboard/prompt/${prompt.id}`}
       />
     )}
     emptyIcon={<FileText className="..." />}
     emptyTitle="No prompts yet"
     emptyDescription="Create your first prompt to get started"
     emptyAction={<CreatePromptButton />}
     noResultsTitle="No prompts found"
     noResultsDescription="Try adjusting your search"
   />
   ```

3. **Keep Dashboard-specific elements**:
   - Header with title + StatsCounter
   - Floating "Create" button (mobile)
   - Header "Create" button (desktop)
   - Any dashboard-specific styling/layout

4. **Clean up** removed code:
   - Remove useState for searchTerm, sortBy, sortDirection
   - Remove inline filtering/sorting logic
   - Remove inline grid rendering
   - Remove inline empty state rendering

5. **Verify existing functionality**:
   - Search still works
   - Sort still works
   - Pinned prompts still appear first
   - Empty states still display correctly
   - Animations still work
  </action>
  <verify>npm run build passes, npm run dev shows Dashboard working exactly as before</verify>
  <done>Dashboard refactored to use usePromptFilters and PromptListView, all existing functionality preserved</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes with no warnings
- [ ] Dashboard displays prompts correctly
- [ ] Search filters prompts by title
- [ ] Sort options work (name, lastUpdated, usage)
- [ ] Sort direction toggle works
- [ ] Pinned prompts appear first
- [ ] Empty state displays when no prompts
- [ ] No results state displays when search has no matches
- [ ] Animations work (staggered card entry)
- [ ] Create button still works (navigates to /dashboard/prompt/new)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Dashboard functionality unchanged from user perspective
- New components exported and ready for reuse
- No code duplication between Dashboard and PromptListView
</success_criteria>

<output>
After completion, create `.planning/phases/12-shared-component-architecture/12-02-SUMMARY.md`
</output>
