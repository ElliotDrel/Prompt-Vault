---
phase: 15.4-public-prompt-ux-improvements
plan: 04
subsystem: dashboard-ui
tags: [react, ui, preview, modal, public-prompts]

requires:
  - "15.4-02-SUMMARY.md (View Public Version button for baseline)"
  - "15.3-02-SUMMARY.md (PublicPromptDetail page for understanding public view)"

provides:
  - "Preview as Public button on Dashboard for public prompts"
  - "PublicPreviewModal showing exact read-only public view"
  - "Modal with info banner explaining preview context"

affects:
  - "Future UX testing (preview should match actual public view exactly)"

tech-stack:
  added: []
  patterns:
    - "Modal preview pattern for WYSIWYG validation"
    - "Conditional button rendering based on prompt visibility"

key-files:
  created:
    - "src/components/PublicPreviewModal.tsx (161 lines)"
  modified:
    - "src/components/PromptView.tsx (added showPreviewButton, onPreview props)"
    - "src/pages/PromptDetail.tsx (modal state management)"

decisions:
  - id: preview-public-only
    choice: "Show Preview button only for public prompts"
    rationale: "User should make prompt public first before previewing (simple, clear workflow)"
    alternatives: ["Allow preview for private prompts to see what public view would look like"]

  - id: preview-tracks-usage
    choice: "Preview modal copy button tracks stats"
    rationale: "Owner is still using their own prompt, stats should reflect actual usage"
    alternatives: ["Disable tracking in preview mode", "Add separate preview tracking"]

  - id: modal-vs-route
    choice: "Modal preview instead of separate route"
    rationale: "Quick validation without leaving context, similar to version history modal"
    alternatives: ["New route like /dashboard/prompt/:id/preview"]

duration: 6m
completed: 2026-02-02
---

# Phase 15.4 Plan 04: Preview as Public Modal Summary

**One-liner:** Dashboard owners can preview exactly what non-owners see via "Preview as Public" button and modal

## What Was Built

Added "Preview as Public" functionality to Dashboard prompt detail view:

1. **PublicPreviewModal component**:
   - Shows exact read-only view non-owners see
   - Info banner: "This is how others see your public prompt"
   - Variable inputs (functional)
   - Copy button (tracks usage stats)
   - Stats display (times used, time saved)
   - NO owner controls (edit, delete, pin, visibility, version history)

2. **Button integration**:
   - "Preview as Public" button in top-right area
   - Eye icon for visual consistency
   - Positioned before "View Public Version" button
   - Only visible for public prompts

3. **State management**:
   - Modal open state in PromptDetail
   - Proper cleanup on close
   - Props flow: PromptDetail → PromptView → modal trigger

## Key Implementation Details

### Modal Layout
```tsx
<Dialog>
  <DialogHeader>Prompt Title</DialogHeader>
  <InfoBanner>"This is how others see your public prompt"</InfoBanner>
  <VariableInputs />
  <CopyButton />
  <PromptBody />
  <Stats />
  <CloseButton />
</Dialog>
```

### Button Placement
```
Dashboard Prompt Detail Header:
[Back to Dashboard]        [Preview as Public] [View Public Version] [Visibility Toggle]
```

### Visibility Logic
- Private prompts: NO preview button
- Public prompts: preview button appears
- Preview button checks: `showPreviewButton && onPreview`
- Modal checks: `prompt.visibility === 'public'`

## Files Modified

**Created:**
- `src/components/PublicPreviewModal.tsx` (161 lines)

**Modified:**
- `src/components/PromptView.tsx`:
  - Added `showPreviewButton?: boolean` prop
  - Added `onPreview?: () => void` prop
  - Added Eye icon import
  - Added preview button rendering before View Public Version

- `src/pages/PromptDetail.tsx`:
  - Imported PublicPreviewModal
  - Added `previewOpen` state
  - Passed `showPreviewButton` and `onPreview` to PromptView
  - Rendered modal with conditional visibility

## Decisions Made

### 1. Preview Public Prompts Only
**Decision:** Show "Preview as Public" button ONLY when prompt is already public

**Rationale:**
- Simple, clear workflow: make public → preview → share
- Matches mental model: "preview what exists, not what could be"
- Reduces UI clutter for private prompts

**Alternative considered:** Allow preview for private prompts to show "what it would look like"
- Would require different messaging ("This is what others WOULD see IF public")
- Adds complexity without clear benefit

### 2. Track Usage in Preview
**Decision:** Copy button in preview modal tracks usage stats

**Rationale:**
- Owner is still using their own prompt
- Stats should reflect all actual usage, including preview testing
- Consistent with main Dashboard behavior

**Alternatives considered:**
- Disable tracking in preview mode: Would lose accurate usage data
- Separate preview tracking: Unnecessary complexity, preview is still usage

### 3. Modal vs Route
**Decision:** Use modal instead of separate route

**Rationale:**
- Quick validation without losing context
- Similar to version history modal (consistent pattern)
- No need for back navigation or state persistence

**Alternative:** `/dashboard/prompt/:id/preview` route
- More complex navigation
- Loses context of main view
- No clear benefit over modal

## Testing Performed

✅ **Build Verification:**
- `npm run lint`: Passed (only existing Fast Refresh warnings)
- `npm run build`: Passed (885.91 kB bundle)

✅ **Component Integration:**
- PublicPreviewModal component created with all required elements
- PromptView accepts new props without breaking
- PromptDetail state management clean

## Next Phase Readiness

**Status:** Phase 15.4 Plan 04 complete

**No blockers for Plan 05** (Modal should be testable in browser UAT)

## Deviations from Plan

None - plan executed exactly as written.

## Commits

- `f07f26e`: feat(15.4-04): create PublicPreviewModal component
- `96c255c`: feat(15.4-04): add Preview as Public button and modal integration

**Total:** 2 commits, 201 lines added

## Notes for Future

- **UX validation:** In UAT, verify preview matches actual public view exactly
- **Stats tracking:** Preview usage counts toward "times used" - document in user-facing help if needed
- **Button order:** Preview → View Public Version → Visibility Toggle (left to right progression)
- **Modal reusability:** PublicPreviewModal could potentially be reused elsewhere (e.g., Library owner prompts)
