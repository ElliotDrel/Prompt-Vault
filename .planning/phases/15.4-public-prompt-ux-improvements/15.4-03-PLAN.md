---
phase: 15.4-public-prompt-ux-improvements
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/PromptCard.tsx
  - src/components/PromptView.tsx
  - src/components/CopyEventCard.tsx
  - src/pages/CopyHistory.tsx
autonomous: true

must_haves:
  truths:
    - "User's own public prompts have visual distinction (colored border) on Library page"
    - "Public prompt detail shows context note about personal copy history"
    - "/history page indicates when copy event is from a public prompt (not owned)"
  artifacts:
    - path: "src/components/PromptCard.tsx"
      provides: "Conditional border styling for owner's prompts in Library"
      contains: "isOwnPrompt"
    - path: "src/components/PromptView.tsx"
      provides: "Context note above Usage History for public prompts"
      contains: "personal copy history"
    - path: "src/components/CopyEventCard.tsx"
      provides: "Visual indicator for public prompt events"
      contains: "isPublicPrompt"
  key_links:
    - from: "src/components/PromptCard.tsx"
      to: "useAuth"
      via: "Compare prompt.authorId with user.id"
      pattern: "authorId.*user"
---

<objective>
Add visual distinction for user's own prompts in Library and provide clearer context about copy history on public prompts.

Purpose:
1. Help users quickly identify their own public prompts when browsing the Library
2. Clarify that Usage History on public prompts is personal (not community-wide)
3. Indicate in copy history when an event is from a public prompt vs owned prompt

Output: PromptCard with owner border, PromptView with context note, CopyEventCard with public indicator
</objective>

<execution_context>
@C:\Users\2supe\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\2supe\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/components/PromptCard.tsx
@src/components/PromptView.tsx
@src/components/CopyEventCard.tsx
@src/pages/CopyHistory.tsx
@src/contexts/PromptsContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add visual distinction for owner's prompts in Library</name>
  <files>src/components/PromptCard.tsx</files>
  <action>
Currently all prompt cards in the Library look the same. User's own public prompts should have a different colored border/outline.

Add a new optional prop to PromptCard:
```tsx
/** Whether this prompt is owned by the current user (for visual distinction in Library) */
isOwnPrompt?: boolean;
```

In the card's className (line 216), add conditional border styling:
```tsx
className={`prompt-card p-6 cursor-pointer flex flex-col gap-4 relative block ${
  prompt.isPinned ? 'ring-2 ring-yellow-400 bg-yellow-50/30' : ''
} ${
  isOwnPrompt ? 'ring-2 ring-primary/50 bg-primary/5' : ''
}`}
```

Note: pinned styling takes priority over own-prompt styling since pinned prompts are only on Dashboard.

The PromptCard is used in PromptListView which is used in multiple places. The `isOwnPrompt` prop should only be passed when rendering Library cards (source='public').

Update the PublicLibrary.tsx or wherever PromptCard is rendered for public prompts:
- Import useAuth
- Compare prompt.authorId === user?.id
- Pass isOwnPrompt={true} when they match

Note: The PromptListView uses a renderPromptCard prop, so the check may need to happen in the page component that provides that render function.
  </action>
  <verify>
1. Go to Library page (/library)
2. Your own public prompts should have a blue-ish border (primary color)
3. Other users' prompts should have the default card styling
4. On Dashboard, cards should NOT have the blue border (only pinned yellow ring applies)
  </verify>
  <done>User's own public prompts visually stand out in the Library with a primary-colored border</done>
</task>

<task type="auto">
  <name>Task 2: Add copy history context note on public prompt detail</name>
  <files>src/components/PromptView.tsx</files>
  <action>
When viewing a public prompt (non-owned or viewing as public), add a context note above or within the "Usage History" accordion explaining that the history is personal.

Add a new optional prop:
```tsx
/** Show context note explaining copy history is personal (for public prompts) */
showCopyHistoryContextNote?: boolean;
```

Add the note near the Usage History section (around line 496-510):
```tsx
{/* Usage History - Separate Card */}
<div className="mt-6">
  <button
    onClick={() => setHistoryExpanded(!historyExpanded)}
    className="flex items-center gap-2 mb-4 text-left font-medium hover:text-primary transition-colors"
  >
    {/* ... existing chevron and text ... */}
  </button>

  {/* Context note for public prompts */}
  {showCopyHistoryContextNote && historyExpanded && (
    <div className="mb-4 flex items-start gap-2 text-sm text-muted-foreground bg-muted/50 p-3 rounded-md">
      <Info className="h-4 w-4 mt-0.5 shrink-0" />
      <p>This shows your personal copy history with this prompt. Other users' activity is private.</p>
    </div>
  )}

  {historyExpanded && (
    <InfiniteScrollContainer ... />
  )}
</div>
```

Import the Info icon from lucide-react.

Pass `showCopyHistoryContextNote={true}` from PublicPromptDetail.tsx to PromptView.

Also ensure the note does NOT show on Dashboard prompt detail (where the user owns the prompt).
  </action>
  <verify>
1. Go to Library -> click someone else's public prompt (or your own viewed as public)
2. Expand "Usage History"
3. Should see a muted info message: "This shows your personal copy history with this prompt. Other users' activity is private."
4. On Dashboard prompt detail, this message should NOT appear
  </verify>
  <done>Public prompt detail shows context note clarifying copy history is personal</done>
</task>

<task type="auto">
  <name>Task 3: Indicate public prompt events on /history page</name>
  <files>src/components/CopyEventCard.tsx, src/pages/CopyHistory.tsx</files>
  <action>
The /history page shows all copy events. Currently there's no indication whether an event came from an owned prompt or a public (non-owned) prompt.

Add visual indicator for public prompts:

1. In CopyEventCard.tsx, add an optional prop:
```tsx
/** Whether the source prompt is a public (non-owned) prompt */
isPublicPrompt?: boolean;
```

2. In the card header area (where title is shown), add a badge when isPublicPrompt is true:
```tsx
<div className="flex-1">
  <div className="flex items-center gap-2">
    <CardTitle className="text-lg">{event.promptTitle}</CardTitle>
    {isPublicPrompt && (
      <Badge variant="outline" className="text-xs text-green-600 border-green-600">
        <Globe className="h-3 w-3 mr-1" />
        Public
      </Badge>
    )}
  </div>
  <p className="text-sm text-muted-foreground mt-1">
    {formatDate(event.timestamp)}
  </p>
</div>
```

Import Globe from lucide-react.

3. In CopyHistory.tsx, determine if each event is from a public prompt:
   - Get the user's owned prompts from PromptsContext
   - For each CopyEvent, check if event.promptId exists in the user's prompts
   - If NOT in user's prompts, it's a public prompt

```tsx
const { prompts } = usePrompts();
const ownedPromptIds = useMemo(() => new Set(prompts.map(p => p.id)), [prompts]);

// When rendering CopyEventCard:
<CopyEventCard
  event={event}
  onDelete={handleDeleteEvent}
  onCopy={handleCopyHistoryEvent}
  isPublicPrompt={!ownedPromptIds.has(event.promptId)}
/>
```

Note: If a prompt was deleted, it won't be in prompts list - treat this as "public" for simplicity (or add separate handling if needed).
  </action>
  <verify>
1. Copy a public prompt from the Library (not your own)
2. Go to /history page
3. The new copy event should have a "Public" badge next to the title with a Globe icon
4. Events from your own prompts should NOT have the badge
  </verify>
  <done>/history page clearly indicates which copy events are from public (non-owned) prompts</done>
</task>

</tasks>

<verification>
- `npm run build` completes without errors
- `npm run lint` passes
- Library shows owner's prompts with distinct border
- Public prompt detail shows context note for copy history
- /history page shows "Public" badge for non-owned prompt events
</verification>

<success_criteria>
- Owner's public prompts in Library have primary-colored border (distinguishable at a glance)
- Context note appears only on public prompt detail, not on Dashboard
- "Public" badge appears on /history for events from non-owned prompts
- All visual indicators are subtle and don't clutter the UI
</success_criteria>

<output>
After completion, create `.planning/phases/15.4-public-prompt-ux-improvements/15.4-03-SUMMARY.md`
</output>
