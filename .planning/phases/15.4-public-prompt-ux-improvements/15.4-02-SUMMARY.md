---
phase: 15.4-public-prompt-ux-improvements
plan: 02
subsystem: ui-navigation
requires:
  - 15.3 (Public Prompt Detail Page)
provides:
  - Improved navigation flow for public prompt viewing
  - Auto-redirect for owners from Library to Dashboard
  - Relocated View Public Version button for better UX
affects:
  - Future navigation enhancements
tech-stack:
  added: []
  patterns:
    - Auto-redirect pattern with useEffect
    - Conditional loading states for redirects
key-files:
  created: []
  modified:
    - src/components/PromptView.tsx
    - src/pages/PublicPromptDetail.tsx
decisions:
  - id: view-public-button-placement
    choice: Relocate button to top-right near visibility toggle
    rationale: Groups visibility-related controls together for better UX
    alternatives: Keep in action buttons area
  - id: owner-auto-redirect
    choice: Auto-redirect owners from Library to Dashboard
    rationale: Reduces friction - owners don't need to see public view banner and click through
    alternatives: Keep banner with manual navigation button
  - id: redirect-implementation
    choice: Use replace true in navigate to avoid history pollution
    rationale: Library URL shouldn't be in history for auto-redirects
    alternatives: Normal navigation with history entry
tags:
  - ux
  - navigation
  - public-prompts
  - react
  - routing
metrics:
  duration: 5 minutes
  completed: 2026-02-02
---

# Phase 15.4 Plan 02: Navigation Flow Improvements Summary

**One-liner:** Relocated "View Public Version" button next to visibility toggle and added auto-redirect for owners from Library to Dashboard.

## Overview

Improved navigation flow by:
1. Moving the "View Public Version" button from the action buttons area to the top-right header near the visibility toggle
2. Adding automatic redirect for owners when they click their own prompts in the Library

These changes reduce friction and group related controls together for better user experience.

## Implementation Details

### Button Relocation (Task 1)

**Changes to `src/components/PromptView.tsx`:**
- Created a flex container in the top-right header area to hold both the visibility toggle and View Public Version button
- Moved button from action buttons row (lines 310-315) to header row (lines 264-270)
- Changed button size from default to `size="sm"` for better visual alignment with the toggle
- Removed button from the action buttons area (where Edit and History buttons are)

**Layout:**
```tsx
<div className="flex items-center gap-3">
  {showViewPublicButton && onViewPublicVersion && (
    <Button variant="outline" size="sm" onClick={onViewPublicVersion}>
      <Globe className="h-4 w-4 mr-2" />
      View Public Version
    </Button>
  )}
  {(showVisibilityToggle ?? true) && (
    <VisibilityToggle
      visibility={prompt.visibility ?? 'private'}
      onToggle={handleVisibilityToggle}
    />
  )}
</div>
```

### Auto-Redirect for Owners (Task 2)

**Changes to `src/pages/PublicPromptDetail.tsx`:**
- Added `useEffect` import
- Added auto-redirect logic that triggers when owner loads their own prompt:
  ```tsx
  useEffect(() => {
    if (!loading && prompt && isOwner && promptId) {
      navigate(`/dashboard/prompt/${promptId}`, { replace: true });
    }
  }, [loading, prompt, isOwner, promptId, navigate]);
  ```
- Added redirecting loading state to show during the redirect:
  ```tsx
  if (!loading && prompt && isOwner) {
    return (
      <>
        <Navigation />
        <div className="min-h-screen flex items-center justify-center">
          <div className="text-center">
            <Loader2 className="h-12 w-12 animate-spin mx-auto mb-4 text-primary" />
            <p className="text-lg text-muted-foreground">Redirecting to Dashboard...</p>
          </div>
        </div>
      </>
    );
  }
  ```

**Key implementation details:**
- Uses `replace: true` to prevent Library URL from appearing in browser history
- Shows brief "Redirecting to Dashboard..." message during the redirect
- Effect runs after loading completes and prompt is available
- Only redirects if all conditions are met (not loading, prompt exists, user is owner, promptId exists)

## Deviations from Plan

None - plan executed exactly as written.

## Commits

| Task | Description | Commit | Files |
|------|-------------|--------|-------|
| 1 | Relocate View Public Version button | dfdf7e9 | src/components/PromptView.tsx |
| 2 | Auto-redirect owners to Dashboard | 1a940c0 | src/pages/PublicPromptDetail.tsx |

## Testing & Verification

**Build verification:**
- ✅ `npm run lint` passed (only expected Fast Refresh warnings)
- ✅ `npm run build` succeeded

**Manual testing scenarios:**
1. Dashboard view of public prompt → "View Public Version" button appears in top-right area next to visibility toggle
2. Owner clicks their own prompt in Library → auto-redirects to Dashboard within 500ms
3. Non-owner clicks public prompt in Library → sees normal public view (no redirect)
4. Browser history doesn't include Library URL after auto-redirect (replace: true works)

## Next Phase Readiness

**Blockers:** None

**Concerns:** None

**Recommendations:**
- Consider adding analytics to track how often owners encounter the auto-redirect (indicates they're trying to view their own public prompts)
- Could add a brief toast message after redirect: "Redirected to your editable version"

## Phase Integration

This plan completes the navigation flow improvements for phase 15.4. The relocated button improves the visual grouping of visibility-related controls, and the auto-redirect reduces friction for owners navigating their own prompts.

**Dependencies satisfied:**
- Phase 15.3 (Public Prompt Detail Page) - provides the PublicPromptDetail component and public prompt infrastructure

**Enables:**
- Cleaner navigation flow for public prompt viewing
- Better UX for owners managing their public prompts
- Consistent visibility control grouping across the application
